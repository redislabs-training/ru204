<style type= text/css>
  .code {font-family: 'courier new', courier; font-weight: bold; font-size: 18px !important;}
</style>
<p>This exercise will further examine the <span class="code">FT.AGGREGATE</span> command and a few of the underlying functions.</p>
<p>Let's start by observing the average page count, max page count, and min page count of books per year released since 2000 in ascending order by year. Make sure to apply a floor function to the average page count for readability.  If we compile this into a bar chart will we notice a trend?</p>
<p><pre class="code">
FT.AGGREGATE index:bookdemo "@year_published:[2000 +inf]" GROUPBY 1 @year_published REDUCE AVG 1 @pages as average_pagecount REDUCE MAX 1 @pages as max_pagecount REDUCE MIN 1 @pages as min_pagecount APPLY floor(@average_pagecount) AS average_pagecount SORTBY 2 @year_published ASC LIMIT 0 21
</pre></p>
<p>Redis returns 21 documents (1 per finished year since 2000) with the average page count, minimum page count, and maximum page count:</p>
<p><pre class="code">
1) "21"
2) 1) "year_published"
   2) "2000"
   3) "average_pagecount"
   4) "873"
   5) "max_pagecount"
   6) "1323"
   7) "min_pagecount"
   8) "238"
3) 1) "year_published"
   2) "2001"
   3) "average_pagecount"
   4) "824"
   5) "max_pagecount"
   6) "1311"
   7) "min_pagecount"
   8) "287"
4) 1) "year_published"
   2) "2002"
   3) "average_pagecount"
   4) "802"
   5) "max_pagecount"
   6) "1390"
   7) "min_pagecount"
   8) "291"
5) 1) "year_published"
   2) "2003"
   3) "average_pagecount"
   4) "795"
   5) "max_pagecount"
   6) "1391"
   7) "min_pagecount"
   8) "203"
6) 1) "year_published"
   2) "2004"
   3) "average_pagecount"
   4) "680"
   5) "max_pagecount"
   6) "1333"
   7) "min_pagecount"
   8) "256"
7) 1) "year_published"
   2) "2005"
   3) "average_pagecount"
   4) "765"
   5) "max_pagecount"
   6) "1342"
   7) "min_pagecount"
   8) "225"
8) 1) "year_published"
   2) "2006"
   3) "average_pagecount"
   4) "869"
   5) "max_pagecount"
   6) "1383"
   7) "min_pagecount"
   8) "210"
9) 1) "year_published"
   2) "2007"
   3) "average_pagecount"
   4) "825"
   5) "max_pagecount"
   6) "1364"
   7) "min_pagecount"
   8) "222"
10) 1) "year_published"
   2) "2008"
   3) "average_pagecount"
   4) "841"
   5) "max_pagecount"
   6) "1374"
   7) "min_pagecount"
   8) "207"
11) 1) "year_published"
   2) "2009"
   3) "average_pagecount"
   4) "754"
   5) "max_pagecount"
   6) "1352"
   7) "min_pagecount"
   8) "225"
12) 1) "year_published"
   2) "2010"
   3) "average_pagecount"
   4) "838"
   5) "max_pagecount"
   6) "1398"
   7) "min_pagecount"
   8) "215"
13) 1) "year_published"
   2) "2011"
   3) "average_pagecount"
   4) "831"
   5) "max_pagecount"
   6) "1396"
   7) "min_pagecount"
   8) "202"
14) 1) "year_published"
   2) "2012"
   3) "average_pagecount"
   4) "760"
   5) "max_pagecount"
   6) "1378"
   7) "min_pagecount"
   8) "231"
15) 1) "year_published"
   2) "2013"
   3) "average_pagecount"
   4) "782"
   5) "max_pagecount"
   6) "1397"
   7) "min_pagecount"
   8) "223"
16) 1) "year_published"
   2) "2014"
   3) "average_pagecount"
   4) "793"
   5) "max_pagecount"
   6) "1393"
   7) "min_pagecount"
   8) "225"
17) 1) "year_published"
   2) "2015"
   3) "average_pagecount"
   4) "777"
   5) "max_pagecount"
   6) "1399"
   7) "min_pagecount"
   8) "221"
18) 1) "year_published"
   2) "2016"
   3) "average_pagecount"
   4) "755"
   5) "max_pagecount"
   6) "1379"
   7) "min_pagecount"
   8) "233"
19) 1) "year_published"
   2) "2017"
   3) "average_pagecount"
   4) "800"
   5) "max_pagecount"
   6) "1391"
   7) "min_pagecount"
   8) "205"
20) 1) "year_published"
   2) "2018"
   3) "average_pagecount"
   4) "803"
   5) "max_pagecount"
   6) "1376"
   7) "min_pagecount"
   8) "206"
21) 1) "year_published"
   2) "2019"
   3) "average_pagecount"
   4) "853"
   5) "max_pagecount"
   6) "1302"
   7) "min_pagecount"
   8) "259"
22) 1) "year_published"
   2) "2020"
   3) "average_pagecount"
   4) "734"
   5) "max_pagecount"
   6) "1396"
   7) "min_pagecount"
   8) "229"
</pre></p>
<p>Here&apos;s a bar chart made from the figures above:</p>
<img style="margin: auto;" src="/static/3.4.1_Hands-on_Graph.png"/>
<p>It appears that the page count for every year since 2000 has remained relatively consistent.</p>
